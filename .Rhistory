x=1+1
x
install.packages("rmarkdown")
library(dplyr)
install.packages(ggplot2)
install.packages("ggplot2)
exit
end
;
library(ggplot2)
library("ggplot2")
library("ggplot2")
install.packages("ggplot2")
install.packages("dplyr")
install.packages("ggrepel")
library(dplyr)
library(ggrepel)
library(ggrepel)
library(ggplot2)
datos <- read.csv("~/Documents/UEM/Modulo_3/G2P/out/Plink_snps2.qassoc", sep="")
datos
snpsOfInterest<-subset(datos, datos$P<=9.0e-04)
don <- datos %>%
# Primero computo el tamaño del cromosoma.
group_by(CHR) %>%
summarise(chr_len=max(BP)) %>%
# Calculo la posicion acumulatica en cada cromosoma
mutate(tot=cumsum(chr_len)-chr_len) %>%
select(-chr_len) %>%
# añado esta informacion a la base de datos original
left_join(datos, ., by=c("CHR"="CHR")) %>%
# Añado la posicion acumulativa de cada SNP
arrange(CHR, BP) %>%
mutate( BPcum=BP+tot) %>%
# Añado los SNP de interes
mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, "yes", "no")) %>%
mutate( is_annotate=ifelse(-log10(P)>4, "yes", "no"))
# Preparo ahora el eje de las x
axisdf <- don %>% group_by(CHR) %>% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )
ggplot(don, aes(x=BPcum, y=-log10(P))) +
# Primero represento todos los puntos
geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +
scale_color_manual(values = rep(c("grey", "skyblue"), 22 )) +
# Adapto el eje de las X:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis
# Añado los SNP de interes
geom_point(data=subset(don, is_highlight=="yes"), color="orange", size=2) +
geom_label_repel( data=subset(don, is_annotate=="yes"), aes(label=SNP), size=2) +
# Lo pongo bonito
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
windows()
qqplot(datos$P)
View(datos)
View(datos)
min(datos$P)
dat<-subset(datos, datos$P>1.0e-20)
windows()
qqplot(dat$P)
qqPlot(dat$P)
install.packages("car")
qqPlot(datos$P)
datos <- read.csv("~/Documents/UEM/Modulo_3/G2P/out/Plink_snps1.qassoc", sep="")
View(datos)
datos <- read.csv("~/Documents/UEM/Modulo_3/G2P/out/Plink_snps1.qassoc", sep="")
snpsOfInterest<-subset(datos, datos$P<=9.0e-04)
don <- datos %>%
# Primero computo el tamaño del cromosoma.
group_by(CHR) %>%
summarise(chr_len=max(BP)) %>%
# Calculo la posicion acumulatica en cada cromosoma
mutate(tot=cumsum(chr_len)-chr_len) %>%
select(-chr_len) %>%
# añado esta informacion a la base de datos original
left_join(datos, ., by=c("CHR"="CHR")) %>%
# Añado la posicion acumulativa de cada SNP
arrange(CHR, BP) %>%
mutate( BPcum=BP+tot) %>%
# Añado los SNP de interes
mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, "yes", "no")) %>%
mutate( is_annotate=ifelse(-log10(P)>4, "yes", "no"))
# Preparo ahora el eje de las x
axisdf <- don %>% group_by(CHR) %>% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )
ggplot(don, aes(x=BPcum, y=-log10(P))) +
# Primero represento todos los puntos
geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +
scale_color_manual(values = rep(c("grey", "skyblue"), 22 )) +
# Adapto el eje de las X:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis
# Añado los SNP de interes
geom_point(data=subset(don, is_highlight=="yes"), color="orange", size=2) +
geom_label_repel( data=subset(don, is_annotate=="yes"), aes(label=SNP), size=2) +
# Lo pongo bonito
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
datos <- read.csv("~/Documents/UEM/Modulo_3/G2P/out/Plink_snps10.qassoc", sep="")
snpsOfInterest<-subset(datos, datos$P<=9.0e-04)
don <- datos %>%
# Primero computo el tamaño del cromosoma.
group_by(CHR) %>%
summarise(chr_len=max(BP)) %>%
# Calculo la posicion acumulatica en cada cromosoma
mutate(tot=cumsum(chr_len)-chr_len) %>%
select(-chr_len) %>%
# añado esta informacion a la base de datos original
left_join(datos, ., by=c("CHR"="CHR")) %>%
# Añado la posicion acumulativa de cada SNP
arrange(CHR, BP) %>%
mutate( BPcum=BP+tot) %>%
# Añado los SNP de interes
mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, "yes", "no")) %>%
mutate( is_annotate=ifelse(-log10(P)>4, "yes", "no"))
# Preparo ahora el eje de las x
axisdf <- don %>% group_by(CHR) %>% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )
ggplot(don, aes(x=BPcum, y=-log10(P))) +
# Primero represento todos los puntos
geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +
scale_color_manual(values = rep(c("grey", "skyblue"), 22 )) +
# Adapto el eje de las X:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis
# Añado los SNP de interes
geom_point(data=subset(don, is_highlight=="yes"), color="orange", size=2) +
geom_label_repel( data=subset(don, is_annotate=="yes"), aes(label=SNP), size=2) +
# Lo pongo bonito
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
datos <- read.csv("~/Documents/UEM/Modulo_3/G2P/out/Plink_snps2.qassoc", sep="")
snpsOfInterest<-subset(datos, datos$P<=9.0e-04)
don <- datos %>%
# Primero computo el tamaño del cromosoma.
group_by(CHR) %>%
summarise(chr_len=max(BP)) %>%
# Calculo la posicion acumulatica en cada cromosoma
mutate(tot=cumsum(chr_len)-chr_len) %>%
select(-chr_len) %>%
# añado esta informacion a la base de datos original
left_join(datos, ., by=c("CHR"="CHR")) %>%
# Añado la posicion acumulativa de cada SNP
arrange(CHR, BP) %>%
mutate( BPcum=BP+tot) %>%
# Añado los SNP de interes
mutate( is_highlight=ifelse(SNP %in% snpsOfInterest, "yes", "no")) %>%
mutate( is_annotate=ifelse(-log10(P)>4, "yes", "no"))
# Preparo ahora el eje de las x
axisdf <- don %>% group_by(CHR) %>% summarize(center=( max(BPcum) + min(BPcum) ) / 2 )
ggplot(don, aes(x=BPcum, y=-log10(P))) +
# Primero represento todos los puntos
geom_point( aes(color=as.factor(CHR)), alpha=0.8, size=1.3) +
scale_color_manual(values = rep(c("grey", "skyblue"), 22 )) +
# Adapto el eje de las X:
scale_x_continuous( label = axisdf$CHR, breaks= axisdf$center ) +
scale_y_continuous(expand = c(0, 0) ) +     # remove space between plot area and x axis
# Añado los SNP de interes
geom_point(data=subset(don, is_highlight=="yes"), color="orange", size=2) +
geom_label_repel( data=subset(don, is_annotate=="yes"), aes(label=SNP), size=2) +
# Lo pongo bonito
theme_bw() +
theme(
legend.position="none",
panel.border = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()
)
View(datos)
View(datos)
View(don)
View(don)
View(snpsOfInterest)
View(snpsOfInterest)
View(don)
View(snpsOfInterest)
View(don)
View(snpsOfInterest)
View(don)
setwd("~/Documents/GitHub/TFM")
setwd("~/Documents/GitHub/TFM")
dat <- read.delim(file="./Raw_Data/GTEx_Analysis_2017-06-05_v8_RNASeQCv1.1.9_gene_reads.gct", skip=2)
View(dat)
View(dat)
head(dat)
dim(dat)
names(dat)
head(dat, 1)
names(dat)
summary(dat)
dat[1:2,1:2]
dat[1:2,1:3]
dat[1:2,1:4]
dat[1:2,1:5]
dat[1:2,1:6]
dat[1:5,1:6]
dat[1:10,1:6]
dim(dat)
if (!requireNamespace("BiocManager", quietly=TRUE)){install.packages("BiocManager")}
if (!requireNamespace("edgeR", quietly=TRUE)){BiocManager::install("edgeR")}
if (!requireNamespace("tidyverse", quietly=TRUE)){install.packages("tidyverse")}
library(edgeR)
library(BiocManager)
library(AnnotationDbi)
library(org.Hs.eg.db)
library(genefu)
library(tidyverse)
?DGEList
?calcNormFactors
View(dat)
y<-DGEList(dat)
dat[1:10,1:6]
matriz<-dat[,dat$Description]
snames<-dat$Description
matriz<-dat[,snames]
dat[2:,1:2]
dat[2,1:2]
dat[2:,1:2]
dat[2:4,2:3]
dat[2:4,2]
dat[2:4,2:]
dat[2:4,-1]
dat[1:1,-1]
genexp1<-dat[,-1]
dat[1:2,1:3]
genexp1[1:2,1:3]
snames<-colnames(genexp1[,-1])
snames[1]
snames[0]
snames[1]
matriz<-dat[,snames]
matrix[1:2,1:3]
genexp2<-genexp1[,snames]
genexp2[1:2,1:3]
genexp1[1:2,1:3]
rownames(genexp1)<-genexp1$Description
sum(duplicated(genexp$Description))
sum(duplicated(genexp1$Description))
sum(duplicated(dat$Description))
sum(duplicated(dat$Name))
rownames(genexp1)<-genexp1$Names
genexp1[1:2,1:3]
genexp1<-dat[,-2].   #elimina la columna description
genexp1<-dat[,-1].   #elimina la columna names
genexp1<-dat[,-2]   #elimina la columna description
genexp1[1:2,1:3]
rownames(genexp1)<-genexp1$Name
genexp1[1:2,1:3]
snames<-colnames(genexp1[,-1])
genexp2<-genexp1[,snames]
genexp2[1:2,1:3]
y<-DGEList(genexp2)
str(genexp)
str(y)
y_norm<-calcNormFactors(y, method = "TMM")
y_norm <- cpm(y_norm, log=T)
str(y_norm)
y_norm <- t(y_norm)
BiocManager::install("hipathia")
library(hipathia)
View(y_norm)
View(y_norm)
genexp1[1:2,1:3]
dat[1:2,1:3]
sum(duplicated(genexp1$Description))
sum(duplicated(genexp1$Name))
sum(duplicated(dim$Description))
sum(duplicated(dat$Description))
sum(duplicated(dat$Name))
